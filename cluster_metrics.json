{
  "paragraphs": [
    {
      "text": "%pyspark\nimport requests\nimport json\nurl1 \u003d \u0027https://us.qubole.com/api/v1.3/clusters\u0027\nheaders\u003d{\u0027X-AUTH-TOKEN\u0027:\u0027c953c449fd5f47d584564e53414d4e7527faa301449f4c85b162b19186182939\u0027}\nresponse \u003d requests.get(url1,headers\u003dheaders)\ndata \u003d json.loads(response.text)\n\n\nprint(\"%html \u003cstyle\u003etable {font-family: arial, sans-serif;border-collapse: collapse;width: 100%;}th{background-color: #555;color:#fff} td, th { border: 1px solid #dddddd;text-align: left;padding: 8px;}tr:nth-child(even) {background-color: #dddddd;}\u003c/style\u003e \u003ctable style\u003d\u0027width:100%\u0027\u003e\u003ctr\u003e\u003cth\u003eCluster Id\u003c/th\u003e\u003cth\u003eCluster Type\u003c/th\u003e\u003cth\u003eCluster Label\u003c/th\u003e\u003cth\u003eCluster Status\u003c/th\u003e\u003cth\u003eMax Nodes\u003c/th\u003e\u003cth\u003eActive Nodes\u003c/th\u003e\u003cth\u003eCPU Utilization\u003c/th\u003e\u003cth\u003eMemory Usage\u003c/th\u003e\u003cth\u003eActive Jobs\u003c/th\u003e\u003c/tr\u003e\")\nfor x in range(len(data[\u0027clusters\u0027])):\n  label \u003d \u0027\u0027\n  clusterId \u003d data[\u0027clusters\u0027][x][\u0027id\u0027]\n  url2 \u003d \u0027https://us.qubole.com/api/v1.3/clusters/\u0027 + str(clusterId) + \u0027/state\u0027\n  #print url2\n  response2 \u003d requests.get(url2, headers\u003dheaders)\n  data2 \u003d json.loads(response2.text)\n  activeNodes \u003d 0;\n  if data2[\u0027state\u0027] \u003d\u003d \u0027DOWN\u0027:\n     activeNodes \u003d 0;\n  else:\n     activeNodes \u003d len(data2[\u0027nodes\u0027])\n  for y in range(len(data[\u0027clusters\u0027][x][\u0027label\u0027])):\n    label +\u003d data[\u0027clusters\u0027][x][\u0027label\u0027][y] + \u0027 \u0027\n  print(\"%html \u003ctr\u003e\u003ctd\u003e\" +  str(data[\u0027clusters\u0027][x][\u0027id\u0027]) + \"\u003c/td\u003e\u003ctd\u003e\" + \u0027Spark\u0027 +  \"\u003c/td\u003e\u003ctd\u003e\" + label + \"\u003c/td\u003e\u003ctd\u003e\" + str(data[\u0027clusters\u0027][x][\u0027state\u0027]) + \"\u003c/td\u003e\u003ctd\u003e\" + str(data[\u0027clusters\u0027][x][\u0027node_configuration\u0027][\u0027max_nodes\u0027]) + \"\u003c/td\u003e\u003ctd\u003e\" + str(activeNodes) + \"\u003c/td\u003e\u003c/tr\u003e\")\n\n\n",
      "user": "snayak@qubole.com",
      "dateUpdated": "Jul 27, 2018 6:25:31 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "paragraphProgress": {
        "jobs": [],
        "numCompletedTasks": 0,
        "numTasks": 0,
        "truncated": false
      },
      "version": "v0",
      "jobName": "paragraph_1532671257909_-189406753",
      "id": "20180727-060057_720672839_q_KBCAPUJ2SG1532671255",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cstyle\u003etable {font-family: arial, sans-serif;border-collapse: collapse;width: 100%;}th{background-color: #555;color:#fff} td, th { border: 1px solid #dddddd;text-align: left;padding: 8px;}tr:nth-child(even) {background-color: #dddddd;}\u003c/style\u003e \u003ctable style\u003d\u0027width:100%\u0027\u003e\u003ctr\u003e\u003cth\u003eCluster Id\u003c/th\u003e\u003cth\u003eCluster Type\u003c/th\u003e\u003cth\u003eCluster Label\u003c/th\u003e\u003cth\u003eCluster Status\u003c/th\u003e\u003cth\u003eMax Nodes\u003c/th\u003e\u003cth\u003eActive Nodes\u003c/th\u003e\u003cth\u003eCPU Utilization\u003c/th\u003e\u003cth\u003eMemory Usage\u003c/th\u003e\u003cth\u003eActive Jobs\u003c/th\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e3640\u003c/td\u003e\u003ctd\u003eSpark\u003c/td\u003e\u003ctd\u003ehadoop1 \u003c/td\u003e\u003ctd\u003eDOWN\u003c/td\u003e\u003ctd\u003e2\u003c/td\u003e\u003ctd\u003e0\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e3641\u003c/td\u003e\u003ctd\u003eSpark\u003c/td\u003e\u003ctd\u003ehadoop2 default \u003c/td\u003e\u003ctd\u003eDOWN\u003c/td\u003e\u003ctd\u003e2\u003c/td\u003e\u003ctd\u003e0\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e3642\u003c/td\u003e\u003ctd\u003eSpark\u003c/td\u003e\u003ctd\u003epresto \u003c/td\u003e\u003ctd\u003eDOWN\u003c/td\u003e\u003ctd\u003e2\u003c/td\u003e\u003ctd\u003e0\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e3643\u003c/td\u003e\u003ctd\u003eSpark\u003c/td\u003e\u003ctd\u003espark \u003c/td\u003e\u003ctd\u003eUP\u003c/td\u003e\u003ctd\u003e2\u003c/td\u003e\u003ctd\u003e3\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e3767\u003c/td\u003e\u003ctd\u003eSpark\u003c/td\u003e\u003ctd\u003eAirflow \u003c/td\u003e\u003ctd\u003eDOWN\u003c/td\u003e\u003ctd\u003e1\u003c/td\u003e\u003ctd\u003e0\u003c/td\u003e\u003c/tr\u003e\n\u003ctr\u003e\u003ctd\u003e6058\u003c/td\u003e\u003ctd\u003eSpark\u003c/td\u003e\u003ctd\u003eus_spark \u003c/td\u003e\u003ctd\u003eDOWN\u003c/td\u003e\u003ctd\u003e2\u003c/td\u003e\u003ctd\u003e0\u003c/td\u003e\u003c/tr\u003e\n"
      },
      "dateCreated": "Jul 27, 2018 6:00:57 AM",
      "dateSubmitted": "Jul 27, 2018 6:25:31 AM",
      "dateStarted": "Jul 27, 2018 6:25:31 AM",
      "dateFinished": "Jul 27, 2018 6:25:35 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 1000
    },
    {
      "text": "%pyspark\nurl1 \u003d \u0027https://us.qubole.com/api/v1.3/clusters/3640/state\u0027\nheaders\u003d{\u0027X-AUTH-TOKEN\u0027:\u0027c953c449fd5f47d584564e53414d4e7527faa301449f4c85b162b19186182939\u0027}\nresponse \u003d requests.get(url1,headers\u003dheaders)\ndata \u003d json.loads(response.text)\nprint data[\u0027state\u0027]\n#print len(data[\u0027nodes\u0027])",
      "user": "snayak@qubole.com",
      "dateUpdated": "Jul 27, 2018 6:22:44 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "paragraphProgress": {
        "jobs": [],
        "numCompletedTasks": 0,
        "numTasks": 0,
        "truncated": false
      },
      "version": "v0",
      "jobName": "paragraph_1532671298776_202865270",
      "id": "20180727-060138_779749632_q_KBCAPUJ2SG1532671255",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "DOWN\n"
      },
      "dateCreated": "Jul 27, 2018 6:01:38 AM",
      "dateSubmitted": "Jul 27, 2018 6:22:44 AM",
      "dateStarted": "Jul 27, 2018 6:22:44 AM",
      "dateFinished": "Jul 27, 2018 6:22:45 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 1000
    },
    {
      "text": "",
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "version": "v0",
      "jobName": "paragraph_1532671434449_474698852",
      "id": "20180727-060354_1560568387_q_KBCAPUJ2SG1532671255",
      "dateCreated": "Jul 27, 2018 6:03:54 AM",
      "status": "READY",
      "progressUpdateIntervalMs": 1000
    }
  ],
  "name": "cluster_metrics",
  "id": "KBCAPUJ2SG1532671255",
  "angularObjects": {
    "2D57M8YPW36431516849633258:shared_process": [],
    "2D45DKDVJ36431516849633138:shared_process": [],
    "2D3QZYXB636431516849633231:shared_process": [],
    "2D6WGCQWU36431516849633273:shared_process": []
  },
  "config": {
    "isDashboard": false,
    "defaultLang": ""
  },
  "info": {},
  "source": "FCN"
}